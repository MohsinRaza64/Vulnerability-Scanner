import customtkinter as ctk
import json

def show_cve_details(cve_id, product, cve_details_json, vulnerability_description):
    details_window = ctk.CTkToplevel()
    details_window.title(f"CVE Details - {product}")
    details_window.geometry("600x400")

    details_textbox = ctk.CTkTextbox(details_window, width=580, height=380)
    details_textbox.pack(padx=10, pady=10)

    cve_details_str = json.dumps(cve_details_json, indent=4)

    details_textbox.insert("0.0", f"CVE ID: {cve_id}\n\n")
    details_textbox.insert("end", f"Product: {product}\n\n")
    details_textbox.insert("end", f"Vulnerability Description:\n{vulnerability_description}\n\n")
    details_textbox.insert("end", f"CVSS Scores:\n{cve_details_str}\n")

    details_textbox.configure(state="disabled")

    details_window.transient()
    details_window.grab_set()

# show_cve_details()